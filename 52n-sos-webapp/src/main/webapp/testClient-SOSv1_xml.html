<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>SOS 1.0.0 TestClient - v2.2</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8" />
<link rel=stylesheet href="style.css" type="text/css" media=screen />
<link rel=stylesheet href="codemirror/default.css" type="text/css" media=screen />
<link rel=stylesheet href="codemirror/codemirror.css" type="text/css" media=screen />
<script src="codemirror/codemirror-compressed.js" type="text/javascript"></script>
<script src="codemirror/xml.js" type="text/javascript"></script>

<script language="JavaScript" type="text/javascript">
		
			var datafolder = window.location.href.substring(0,
				     window.location.href.lastIndexOf("/") + 1) +
				     "examples/sos_v100/requests_xml/";
			
			var editor = null;
			var defaultString = "<!-- Insert your request here or select one of the examples from the menu above. -->";
			
			function load()
			{
				if(editor == null) {
					initEditor();
				}
				
				var placeholderIndex = "PLACEHOLDER";
				//load files
				var requests=new Array();
				var index = 0;
				requests[index++]=datafolder+"GetCapabilities/GetCapabilities_allSections.xml";
				requests[index++]=datafolder+"DescribeSensor/DescribeSensor_basicRequest.xml";
				
				requests[index++]=datafolder+"GetFOI/GetFoi_foiID.xml";
				
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_BBOX.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Contains_Envelope.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Contains_LineString.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Contains_Point.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Contains_Polygon.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Intersects_Envelope.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Intersects_LineString.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Intersects_Point.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Intersects_Polygon.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Overlaps_Envelope.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Overlaps_LineString.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Overlaps_Point.xml";
				requests[index++]=datafolder+"GetFOI/SpatialFilter/getFoi_SF_Overlaps_Polygon.xml";
				
				requests[index++]=datafolder+"GetFOI/GetFoiTime.xml";
				//requests[index++]=placeholderIndex;
				
				requests[index++]=datafolder+"GetObservation/GetObs_allParameters.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_basic.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_foiID.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_getFirstObs.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_latestObs.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_procedure.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_spatialObs_basic.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_spatialObs_foi.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_spatialObs_geometry.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_multiple_procedures.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_timePeriod.xml";
		
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Num_Betw.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Num_ET.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Num_GT.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Num_GTOET.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Num_IsLike.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Num_IsNull.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Num_LT.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Num_LTOET.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Num_NET.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Text_ET.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Text_IsLike.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Text_IsNull.xml";
				requests[index++]=datafolder+"GetObservation/ResultFilter/GetObs_RF_Text_NET.xml";
		
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_BBOX.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Contains_Envelope.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Contains_LineString.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Contains_Point.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Contains_Polygon.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Intersects_Envelope.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Intersects_LineString.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Intersects_Point.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Intersects_Polygon.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Overlaps_Envelope.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Overlaps_LineString.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Overlaps_Point.xml";
				requests[index++]=datafolder+"GetObservation/SpatialFilter/getObs_SF_Overlaps_Polygon.xml";
				
				requests[index++]=datafolder+"GetObservation/GetObs_basic_allTypes.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_allTypes_Measurements.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_allTypes_CategoryObs.xml";
				requests[index++]=datafolder+"GetObservation/GetObs_allTypes_SpatialObs.xml";
				
				requests[index++]=datafolder+"GetResult/GetObs4GetResult_FoiID.xml";
				requests[index++]=datafolder+"GetResult/getResult.xml";
				requests[index++]=datafolder+"GetResult/getResultTime.xml";
		
				requests[index++]=datafolder+"InsertObservation/InsertObs_geometry_movingObject.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObs_geometry.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObservation_categoryObservation.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObservation_samplingSurface.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObservation_samplingPoint.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObservation_GenericObs_Derwent.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObservation_GenericObs_Derwent_2.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObservation_4_RegSen_withFOI.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObservation_Measurement.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObservation_GenericObs_allTypes.xml";
				requests[index++]=datafolder+"InsertObservation/InsertObservation_GenericObs_noIDs.xml";
				
				requests[index++]=datafolder+"RegisterSensor/RegisterSensor_categoryObservation.xml";
				requests[index++]=datafolder+"RegisterSensor/RegisterSensor_measurement.xml";
				requests[index++]=datafolder+"RegisterSensor/RegisterSensor_Measurement_Derwent.xml";
				requests[index++]=datafolder+"RegisterSensor/RegisterSensor_Observation_Derwent_2.xml";
				requests[index++]=datafolder+"RegisterSensor/RegisterSensor_geometry.xml";
				requests[index++]=datafolder+"RegisterSensor/RegisterSensor_withFOI.xml";
				requests[index++]=datafolder+"RegisterSensor/RegisterSensor_Observation_allTypes.xml";
				requests[index++]=datafolder+"RegisterSensor/RegisterSensor_Observation_noIDs.xml";
		
				//fill the select element
				var selRequest = document.getElementById("selRequest");
				
				l = requests.length;
				for (var i=0; i<l; i++ ){
					var requestString = "";
					if(requests[i] == placeholderIndex) {
						//skip this one
					}
					else {
						try {
							
							var name = requests[i].substring(requests[i].lastIndexOf("/") + 1, requests[i].length);
							selRequest.add(new Option(name, requests[i]), null);
						} catch(err) {
							var txt="";
							txt+="Error loading file: " + requests[i];
							txt+="Error: " + err + "\n\n";
							var requestTextarea = document.getElementById('requestTextarea').value = "";
							requestTextarea.value+=txt;
						}
					}
				}
			}
				
			function insertSelected() {
				try {
					var selObj = document.getElementById('selRequest');
					var requestTextarea = document.getElementById('requestTextarea');
					var requestString = "";
		
					if(selObj.selectedIndex != 0) // Handle selection of empty drop down entry.
						requestString = getFile(selObj.options[selObj.selectedIndex].value);
					
		      		if(requestString == null){
		      			requestString = "Sorry! There is a problem, please refresh the page.";
		      		}
		
				  	editor.setValue(requestString);
				  	
					} catch(err) {
						var txt="";
						txt+="Error loading file: " + selObj.options[selObj.selectedIndex].value;
						txt+="Error: " + err + "\n\n";
						requestTextarea.value+=txt;
					}
		  
			}
		  
		  	function getFile(fileName){
		     	oxmlhttp = null;
		     	try{
		       		oxmlhttp = new XMLHttpRequest();
		       		oxmlhttp.overrideMimeType("text/xml");
		     	}
		     	catch(e){
		       		try{
		         		oxmlhttp = new ActiveXObject("Msxml2.XMLHTTP");
		       		}
		       		catch(e){
		         		return null;
		       		}
		     	}
		     	if(!oxmlhttp) return null;
		     	try{
		       		oxmlhttp.open("GET",fileName,false);
		       		oxmlhttp.send(null);
		     	}
		     	catch(e){
		       		return null;
		     	}
		     	return oxmlhttp.responseText;
		  	}
		
		  	function initEditor() {
				editor = CodeMirror.fromTextArea(
					document.getElementById("requestTextarea"), 
					{
					height: "420px",
					//parserfile: "parsexml.js",
					//stylesheet: "codemirror/xmlcolors.css",
					//path: "codemirror/",
					//lineNumbers: true,
					mode: {name: "xml"},
					readOnly: false,
					lineWrapping: true,
					lineNumbers: true,
				});
				editor.setValue(defaultString);
		  	}
		
		</script>

</head>
<body bgcolor="#ffffff" text="#000000" onload="load()">

<div id="content">
	<div id="header">
		<div id="headline">
			<span class="title">SOS 1.0.0 TestClient</span><span class="infotext">Version 2</span>
			<div class="infotext"><br/><br/>For more information about the 52°North Sensor Observation Service visit <a href="http://52north.org/sos">http://52north.org/sos</a>.</div>
		</div>
		<div id="logo"><a href="http://www.52north.org/" target="_blank"><img
			src="http://52north.org/templates/52n/images/logo.gif"
			border="0" alt="52North Logo" /></a>
		</div>
	</div>

	<form name="urlform" method="post" action="">
		<h3>Service URL:&nbsp;&nbsp; <span> <input name="url"
			value="${conf.sos.service.url}/sos/xml" size="80"
			type="text" /> </span></h3>
	</form>

	<h3>Request Examples:&nbsp;&nbsp; <select id="selRequest"
		onchange="insertSelected();">
		<option value=" "></option>
	</select></h3>

	<span class="infotext">You can change the examples in the folder <font face="monospace">[project-directory]/52n-sos-service/src/main/webapp/examples/</font>.</span>

	<div class="request-form">
		<form name="requestform" method="post" action="">
			<div class="editorBorder">
				<textarea name="request" id="requestTextarea"></textarea>
			</div>
			<div class="request-form-buttons">
				<input value="Send" onclick="requestform.action = urlform.url.value" type="submit" />
				<input value="Clear" name="reset" type="reset" onclick="document.getElementById('selRequest').selectedIndex = 0; insertSelected();" />
			</div>
		</form>
		<div class="GetCapabilities"><font size="2">HTTP-GET for GetCapabilities: <a href="${conf.sos.service.url}/xml?service=SOS&REQUEST=GetCapabilities&AcceptVersions=1.0.0">Link</a></font></div>
		<p class="infotext">This TestClient was successfully tested in Firefox 3.5.2, Safari 4.0.3, Opera 9.64 and InternetExplorer 8.0.6001.18702 and should work properly in Firefox 1.0 or higher, Safari 1.2 or higher, Opera 8 or higher and InternetExplorer 5 or higher. The editor is based on CodeMirror (http://marijn.haverbeke.nl/codemirror/).</p>
	</div>
</div>

</body>
</html>